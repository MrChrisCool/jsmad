var fs = require('fs');

var data = fs.readFileSync("one_second_of_silence");
var stream = new Mad.Stream(data);

console.log("Reading a " + Math.round(stream.bufend / 1024) + "KB file");

ID3_skipHeader(stream);

var STEPS_COUNT = 0;

var synth = new Mad.Synth();
var frame = Mad.Frame.decode(stream);

if(frame == null) {
    if(stream.error == Mad.Error.BUFLEN) {
        console.log("End of file!");
    }
    console.log("Error! code = " + stream.error);
}

var channelCount = frame.header.nchannels();
var preBufferSize = file.length;
var sampleRate = frame.header.samplerate;

console.log("playing " + channelCount + " channels, samplerate = " + sampleRate + " audio.");

synth.frame(frame);
